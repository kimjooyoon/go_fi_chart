# 애그리게잇 정의

## 1. 자산 관리 (AssetAggregate)
### 구성요소
- Asset (루트)
- Transaction
- RecurringTransaction
- Category
- Portfolio

### 불변식
- 거래 금액은 0보다 커야 함
- 포트폴리오 비중의 총합은 100%
- 자산 가치는 항상 최신으로 유지
- 정기 거래는 유효한 주기를 가져야 함

### 책임
- 거래 기록 관리
- 자산 가치 평가
- 포트폴리오 구성 관리
- 정기 거래 실행

## 2. 재무 목표 (FinancialGoalAggregate)
### 구성요소
- Goal (루트)
- GoalProgress
- Milestone
- GoalStrategy

### 불변식
- 목표 금액은 0보다 커야 함
- 목표 기간은 현재보다 미래여야 함
- 마일스톤은 순차적으로 설정
- 진행률은 0-100% 범위 내

### 책임
- 목표 설정 및 수정
- 진행 상황 추적
- 달성 가능성 평가
- 전략 추천

## 3. 분석 엔진 (AnalysisEngineAggregate)
### 구성요소
- Analysis (루트)
- FinancialMetrics
- Pattern
- Recommendation
- RiskProfile

### 불변식
- 분석은 충분한 데이터 기반
- 지표는 정해진 공식으로 계산
- 추천은 위험 성향 고려
- 패턴은 통계적 유의성 확보

### 책임
- 재무 상태 분석
- 패턴 감지
- 개선점 도출
- 맞춤형 조언 생성

## 4. 보상 시스템 (RewardSystemAggregate)
### 구성요소
- Reward (루트)
- Achievement
- Badge
- ProgressTracker
- Milestone

### 불변식
- 보상은 명확한 조건 달성 시 지급
- 뱃지는 중복 획득 불가
- 진행률은 실제 데이터 기반
- 마일스톤은 순차적 달성

### 책임
- 목표 달성 추적
- 보상 지급
- 진행 상황 관리
- 업적 관리

## 5. 커뮤니티 (CommunityAggregate)
### 구성요소
- Community (루트)
- Content
- Mentor
- Rating
- Discussion

### 불변식
- 컨텐츠는 검증 과정 필요
- 멘토는 자격 요건 충족
- 평가는 실제 사용자만 가능
- 토론은 가이드라인 준수

### 책임
- 컨텐츠 관리
- 멘토링 시스템 운영
- 평가 시스템 관리
- 커뮤니티 규칙 적용

## 애그리게잇 간 경계
### 트랜잭션 경계
1. 단일 애그리게잇 수정
- 하나의 트랜잭션에서는 단일 애그리게잇만 수정
- 다중 애그리게잇 수정은 도메인 이벤트로 처리

2. 일관성 수준
- 애그리게잇 내부: 강한 일관성
- 애그리게잇 간: 최종 일관성

### 참조 규칙
1. ID 참조
- 다른 애그리게잇은 ID로만 참조
- 직접 객체 참조 금지

2. 조회 규칙
- 각 애그리게잇은 자체 레포지토리 사용
- 필요한 경우 전용 조회 모델 사용

### 이벤트 처리
1. 도메인 이벤트
- 애그리게잇 변경 시 이벤트 발행
- 다른 애그리게잇은 이벤트 구독

2. 이벤트 핸들링
- 비동기 처리 우선
- 실패 시 재시도 메커니즘